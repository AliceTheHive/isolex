metadata:
  kind: github-pr-controller
  name: test-pr
data:
  client:
    agent: ssube/isolex/controller/github/pull-request
    app:
      id: !env ISOLEX_GITHUB_APP_ID
      key: !env ISOLEX_GITHUB_APP_KEY
    installation:
      id: !env ISOLEX_GITHUB_APP_INSTALLATION
  transforms:
    - metadata:
        kind: template-transform
        name: github-pr-template
      data:
        templates:
          body: >-
            {{#entries this }}
              {{#each value }}
                {{#if title }}
                  PR#{{ number }}: {{ title }} (by {{ user.login }})
                {{/if }}
              {{/each }}
            {{/entries }}
    - metadata:
        kind: flatten-transform
        name: github-pr-body
      data:
        join: " "
        keys: [$.body]